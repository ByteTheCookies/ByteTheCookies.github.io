               

<!DOCTYPE html>
<html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <link rel="shortcut icon" href='http://localhost:1313/favicon.ico' type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Crack Me - ByteTheCookies</title>

    

    

    
    <meta name="author" content="ByteTheCookies" />
    

    
        <meta property="og:url" content="http://localhost:1313/writeups/sekaictf2024/crackme/">
  <meta property="og:site_name" content="ByteTheCookies">
  <meta property="og:title" content="Crack Me">
  <meta property="og:description" content="Crack Me Description: Developed for SekaiCTF 2022 but never got a chance to release it. Can you log in and claim the flag?
Introduction First rev ctf of Sekai 2024 with an apk attached, so we have a mobile challenge on our hands. The first thing to do (which I strongly advise against in a real environment) is to download and install the app to get a quick overview of what it does.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:published_time" content="2024-08-26T17:04:19+02:00">
    <meta property="article:modified_time" content="2024-08-27T15:04:40+02:00">
    <meta property="article:tag" content="Rev">
    <meta property="article:tag" content="Mobile">
    <meta property="article:tag" content="Javascript/Java">
    <meta property="article:tag" content="Information Leaking">
    <meta property="article:tag" content="100">
    <meta property="article:tag" content="187">

    

    
        
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Crack Me">
  <meta name="twitter:description" content="Crack Me Description: Developed for SekaiCTF 2022 but never got a chance to release it. Can you log in and claim the flag?
Introduction First rev ctf of Sekai 2024 with an apk attached, so we have a mobile challenge on our hands. The first thing to do (which I strongly advise against in a real environment) is to download and install the app to get a quick overview of what it does.">

    <link rel="stylesheet" href="/style.css" integrity="">



    <link rel="stylesheet" href="/lib/css/prism.css" integrity="">



    
    <script>
        if (!('theme' in localStorage)) {
            localStorage.theme = 'dark';
        }

        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.setAttribute("data-theme", "dark");
        } else {
            document.documentElement.setAttribute("data-theme", "light");
        }
    </script>
<script defer src="/js/header.js" integrity=""></script>



    <script defer src="/js/zooming.js" integrity=""></script>







    
        

        
        

        
        
            
        

        <script defer src="/js/prism.js" integrity="" data-manual></script>
    



    
    
    
    <script defer src="/js/search-en.js" integrity=""></script>




<link rel="stylesheet" href="http://localhost:1313/user.css">

    
</head>
<body><header>
    <div id="header_left">
        <div id="sidebar_btn">
            <input type="checkbox" id="sidebar_btn_input" class="hidden" />
            <label id="sidebar_btn_label" for="sidebar_btn_input">
                <svg id="menu_icon" width="26px" height="26px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
</svg>

</svg>
            </label>
            <label id="sidebar_canvas_overlay_wrapper" for="sidebar_btn_input">
                <div id="sidebar_canvas_overlay"></div>
            </label>
            <div id="sidebar">
                <ul><li>
                            <a href="/">üíª About</a></li><li>
                            <a href="/news/">üì∞ News</a></li><li>
                            <a href="/writeups/">üìë Writeups</a></li><li>
                            <a href="/contacts/">‚úâÔ∏è Contacts</a></li></ul>
            </div>
        </div>
    
        <div class="brand">
            <div>
                <a href="/">ByteTheCookies</a>
            </div>
        </div>
    </div>

    <div class="toolbox">
        <div id="theme_tool">
            <svg id="dark_mode_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

</svg>
            <svg id="light_mode_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
</svg>

</svg>
        </div>

        
            <div id="search_tool">
                <svg id="search_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
</svg>

</svg><div id="search_menu_wrapper" class="hidden">
    <div id="search_menu">
        <div id="search_menu_toolbar">
            <div id="search_menu_input_wrapper">
                <input id="search_menu_input" type="text" placeholder='Search Posts'>
            </div>
            <div id="search_menu_close_btn">
                <svg width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line>
</svg>

</svg>
            </div>
        </div>
        <div id="search_menu_results">
        </div>
    </div>
</div>
</div>
        

        
    </div>
</header>
<nav id="navbar" class="pure-menu">
    <ul class="pure-menu-list"><li class="navbar-item pure-menu-item ">
                    
                        <a href="/" class="pure-menu-link">üíª About</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="/news/" class="pure-menu-link">üì∞ News</a>
                    
                </li><li class="navbar-item pure-menu-item insection">
                    
                        <a href="/writeups/" class="pure-menu-link">üìë Writeups</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="/contacts/" class="pure-menu-link">‚úâÔ∏è Contacts</a>
                    
                </li></ul>
</nav>
<main>
      <div id="content" class="content-margin">
        
    
    <details class="collapsible-menu-wrapper"><summary class="collapsible-menu-type"><span>Table of contents</span></summary><div class="collapsible-menu">
        
            <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#first-step">First step</a></li>
    <li><a href="#second-step">Second Step</a></li>
    <li><a href="#third-step">Third Step</a></li>
    <li><a href="#fourth-step">Fourth Step</a></li>
    <li><a href="#fifth-step">Fifth step</a></li>
    <li><a href="#unintended-solution">Unintended solution</a></li>
    <li><a href="#intended-solution-the-one-i-performed">Intended solution (The one i performed)</a></li>
    <li><a href="#solution">Solution</a></li>
  </ul>
</nav>
        
    </div></details>



<div class="tags">
  
    <div class="badge">Rev</div>

  
    <div class="badge">Mobile</div>

  
    <div class="badge">Javascript/Java</div>

  
    <div class="badge">Information leaking</div>

  
    <div class="badge">100</div>

  
    <div class="badge">187</div>

  
    <div class="badge">Sahuang</div>

  
</div>

<div>
  <p class="date">
    Last edit: Aug 26, 2024
  </p>
</div>


    <div class="content-margin">



<article >
    
    
        
        
    
    <h1 style='text-decoration: underline;text-decoration-color: #9e8c6c;font-size: 3em;'>Crack Me</h1>
<p><strong>Description</strong>: Developed for SekaiCTF 2022 but never got a chance to release it. Can you log in and claim the flag?</p>

<h2>Introduction</h2>

<p>First rev ctf of Sekai 2024 with an apk attached, so we have a mobile challenge on our hands.
The first thing to do (which I strongly advise against in a real environment) is to download and install the app to get a quick overview of what it does.</p>
<div style="display:flex; height:50vh">
  <img alt="img-app1" style="margin:0px" src="/images/crackme/app-image1.jpeg">
  <img alt="img-app1" style="margin:0px" src="/images/crackme/app-image2.jpeg">
</div>
<p>As you can see, the app doesn&rsquo;t allow us to do much more than press the button and log in (without being able to register).</p>

<h2>First step</h2>

<p>The first thing I did was to analyse the apk using an online tool. <a href="https://sisik.eu/apk-tool">SISIK</a></p>
<p>And two interesting pieces of information came up: the first was that it was a react-native app, which helps us a lot in reverse, and that the app was using firebase to handle the backend and probably authentication as well.</p>

<h2>Second Step</h2>

<p>The apk is actually a compressed set of java files like a zipper and tar, this then allows us to easily extract the contents with any tool like unzip or 7z (in my case I used extract which is a utils of zsh).</p>
<p>Once we have extracted the contents we should find something like this</p>
<p><img alt="alt text" src="/images/crackme/image.png"></p>
<p>As we can see, we have a huge number of files, but this is where tools like <a href="https://www.gnu.org/software/grep/manual/grep.html">grep</a> or <a href="https://github.com/junegunn/fzf">fzf</a> come in.</p>
<p>This allows us to search for files based on keywords as in my case: admin,sekai,user,password</p>
<p>After some research we can find us an obfuscated js file named: index.android.bundle</p>
<p>After some research we can find there a file named index.android.bundle with some obfuscated javascript inside, knowing that the application is written in react-native and that inside this file there are keywords like: admin,sekai,password, it is definitely an interesting file.</p>

<h2 id="third-step" class="header-anchor-wrapper">Third Step
  <a href="#third-step" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<p>One possible idea might be a react-native app decompiler, which fortunately exists and is easy to find in the case I used: <a href="https://github.com/numandev1/react-native-decompiler">React Native Decompiler</a></p>
<p>Once installed, and running the command <code>react-native-decompiler index.android.bundle -o bundle_deobfuscated</code>, we should find about 800 js files, a bit confusing but understandable with a little effort.</p>

<h2 id="fourth-step" class="header-anchor-wrapper">Fourth Step
  <a href="#fourth-step" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<p>We can reuse grep and fzf to search again for the words of interest.</p>
<p>By searching, we manage to find a really interesting file, in which we find the login system that is done in the application.</p>
<pre  class="mc-prism hide language-text" ><code class="language-javascript">function _() {
  var e, o;
  module25.default(this, _);
  (e = L.call(this, ...args)).state = {
    email: &quot;&quot;,
    password: &quot;&quot;,
    wrongEmail: false,
    wrongPwd: false,
    checked: false,
    verifying: false,
    errorTitle: &quot;&quot;,
    errorMessage: &quot;&quot;,
  };
  e._verifyEmail =
    ((o = module275.default(function* (t) {
      t.setState({
        verifying: true,
      });
      var n = module478.initializeApp(module477.default),
        o = module486.getDatabase(n);
      if (
        &quot;admin@sekai.team&quot; !== t.state.email ||
        false === e.validatePassword(t.state.password)
      )
        console.log(&quot;Not an admin account.&quot;);
      else console.log(&quot;You are an admin...This could be useful.&quot;);
      var s = module488.getAuth(n);
      module488
        .signInWithEmailAndPassword(s, t.state.email, t.state.password)
        .then(function (e) {
          t.setState({
            verifying: false,
          });
          var n = module486.ref(o, &quot;users/&quot; + e.user.uid + &quot;/flag&quot;);
          module486.onValue(n, function () {
            t.setState({
              verifying: false,
            });
            t.setState({
              errorTitle: &quot;Hello Admin&quot;,
              errorMessage: &quot;Keep digging, you are almost there!&quot;,
            });
            t.AlertPro.open();
          });
        })
        .catch(function (e) {
          // Different error messages
        });
    })),
    function (e) {
      return o.apply(this, arguments);
    });

  e.validatePassword = function (e) {
    if (17 !== e.length) return false;
    var t = module700.default.enc.Utf8.parse(module456.default.KEY),
      n = module700.default.enc.Utf8.parse(module456.default.IV);
    return (
      &quot;03afaa672ff078c63d5bdb0ea08be12b09ea53ea822cd2acef36da5b279b9524&quot; ===
      module700.default.AES.encrypt(e, t, {
        iv: n,
      }).ciphertext.toString(module700.default.enc.Hex)
    );
  };
}
</code></pre>
<p>Now let&rsquo;s analyse the operation of the login&hellip; as we can see the email that checks for the login is only one, that of the admin <code>admin@sekai.team</code> and the password is checked with a function in particular <code>validatePassword</code>.</p>
<p>Going to analyse the function, we see that the decryption of a hex string is done via AES, but even more important detail, the IV and the Key are imported from another file, by analysing the form in question we can find out the value of the IV and the Key.</p>
<pre  class="mc-prism hide language-text" ><code class="language-javascript">var _ = {
  LOGIN: &quot;LOGIN&quot;,
  EMAIL_PLACEHOLDER: &quot;user@sekai.team&quot;,
  PASSWORD_PLACEHOLDER: &quot;password&quot;,
  BEGIN: &quot;CRACKME&quot;,
  SIGNUP: &quot;SIGN UP&quot;,
  LOGOUT: &quot;LOGOUT&quot;,
  KEY: &quot;react_native_expo_version_47.0.0&quot;,
  IV: &quot;__sekaictf2023__&quot;,
};
exports.default = _;
</code></pre>
<p>This allows us to easily find the password even with a trivial Python script like this one:</p>
<pre  class="mc-prism hide language-text" ><code class="language-python">
from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad

key = b&quot;react_native_expo_version_47.0.0&quot;[:32]
iv = b&quot;__sekaictf2023__&quot;
ciphertext = binascii.unhexlify(
    &quot;03afaa672ff078c63d5bdb0ea08be12b09ea53ea822cd2acef36da5b279b9524&quot;)
email = &quot;admin@sekai.team&quot;

def decrypt_password():
  cipher = AES.new(key, AES.MODE_CBC, iv)
  decrypted = unpad(cipher.decrypt(ciphertext), AES.block_size)

  password = decrypted.decode('utf-8')
  assert len(password) == 17

  return password

  def main():
    password = decrypt_password()
    print(&quot;password:&quot;, password)
    print(&quot;email: &quot;, email)

if __name__ == '__main__':
    main()


# OUTPUT:

# password: s3cr3t_SEKAI_P@ss
# email: admin@sekai.team

</code></pre>
<p><strong>PERFECT</strong>! It&rsquo;s done, we have the flag, we just need to log in to the application</p>
<img alt="img-app3" style="height:50vh; margin:0px" src="/images/crackme/app-image3.jpeg">
<p>OR MAYBE NOT üò•&hellip;</p>

<h2 id="fifth-step" class="header-anchor-wrapper">Fifth step
  <a href="#fifth-step" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<p>After a moment&rsquo;s panic, I resume checking the code and how the login system works; indeed, we can see that as soon as the login is complete, a request is made to the database (probably the <a href="https://firebase.google.com/docs/database">firebase realtime database</a>)</p>
<p>So, in a sense, the flag has been given to us, we just have to catch it on the fly, and there are two ways of doing that.</p>

<h2 id="unintended-solution" class="header-anchor-wrapper">Unintended solution
  <a href="#unintended-solution" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<p>The first solution was to intercept the call and answer from the app to the db and vice versa, but using arch with an NVIDIA video card I had trouble with Android emulation, but you can still find a solution. <a href="https://ggcoder.medium.com/solving-crackme-from-sekaictf-9660dc41b0ce">similar solution</a></p>

<h2 id="intended-solution-the-one-i-performed" class="header-anchor-wrapper">Intended solution (The one i performed)
  <a href="#intended-solution-the-one-i-performed" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<p>Given my difficulties with the emulation of the application, I continued my search for code, this time also searching Firebase, and managed to find something very interesting</p>
<pre  class="mc-prism hide language-text" ><code class="language-javascript">var c = {
  apiKey: &quot;AIzaSyCR2Al5_9U5j6UOhqu0HCDS0jhpYfa2Wgk&quot;,
  authDomain: &quot;crackme-1b52a.firebaseapp.com&quot;,
  projectId: &quot;crackme-1b52a&quot;,
  storageBucket: &quot;crackme-1b52a.appspot.com&quot;,
  messagingSenderId: &quot;544041293350&quot;,
  appId: &quot;1:544041293350:web:2abc55a6bb408e4ff838e7&quot;,
  measurementId: &quot;G-RDD86JV32R&quot;,
  databaseURL: &quot;https://crackme-1b52a-default-rtdb.firebaseio.com&quot;,
};
exports.default = c;
</code></pre>
<p>As you can see, we are faced with a firebase configuration file with sensitive information that allows us to connect directly to the firebase database using js.
So in the end we just need to replicate the functions used in the login to get the flag.</p>

<h2 id="solution" class="header-anchor-wrapper">Solution
  <a href="#solution" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<p>&hellip;</p>
<pre  class="mc-prism hide language-text" ><code class="language-python"># filename: exploit.py

from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad
import binascii
import subprocess

key = b&quot;react_native_expo_version_47.0.0&quot;[:32]
iv = b&quot;__sekaictf2023__&quot;
ciphertext = binascii.unhexlify(
    &quot;03afaa672ff078c63d5bdb0ea08be12b09ea53ea822cd2acef36da5b279b9524&quot;)
email = &quot;admin@sekai.team&quot;


def get_flag(email, password):
    process = subprocess.Popen(
        [&quot;node&quot;, &quot;exploit.js&quot;, email, password],
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE
    )

    stdout, stderr = process.communicate()

    print(stdout.decode('utf-8'))

    if stderr:
        print(stderr.decode('utf-8'))

def decrypt_password():
  cipher = AES.new(key, AES.MODE_CBC, iv)
  decrypted = unpad(cipher.decrypt(ciphertext), AES.block_size)

  password = decrypted.decode('utf-8')
  assert len(password) == 17

  return password

def main():
    password = decrypt_password()
    print(&quot;password:&quot;, password)
    print(&quot;email: &quot;, email)
    get_flag(email, password)


if __name__ == '__main__':
    main()

</code></pre>
<pre  class="mc-prism hide language-text" ><code class="language-javascript">// filename: exploit.js
import { initializeApp } from &quot;firebase/app&quot;;
import { getAuth, signInWithEmailAndPassword } from &quot;firebase/auth&quot;;
import { getDatabase, ref, get } from &quot;firebase/database&quot;;
import { exit } from &quot;process&quot;;

let app = initializeApp({
  apiKey: &quot;AIzaSyCR2Al5_9U5j6UOhqu0HCDS0jhpYfa2Wgk&quot;,
  authDomain: &quot;crackme-1b52a.firebaseapp.com&quot;,
  storageBucket: &quot;crackme-1b52a.appspot.com&quot;,
  projectId: &quot;crackme-1b52a&quot;,
  messagingSenderId: &quot;544041293350&quot;,
  appId: &quot;1:544041293350:web:2abc55a6bb408e4ff838e7&quot;,
  measurementId: &quot;G-RDD86JV32R&quot;,
  databaseURL: &quot;https://crackme-1b52a-default-rtdb.firebaseio.com&quot;,
});

var db = getDatabase(app);
var auth = getAuth(app);

async function loginAndGetFlag(email, password) {
  try {
    const userCredential = await signInWithEmailAndPassword(
      auth,
      email,
      password
    );
    console.log(&quot;Logged in&quot;);
    var n = ref(db, &quot;users/&quot; + userCredential.user.uid + &quot;/flag&quot;);

    const snapshot = await get(n);
    if (snapshot.exists()) {
      console.log(&quot;Flag value:&quot;, snapshot.val());
    }
  } catch (error) {
    console.error(&quot;Error logging in or fetching flag:&quot;, error);
  }
}

const args = process.argv.slice(2);
const email = args[0];
const password = args[1];
</code></pre>
<pre  class="mc-prism hide language-text" ><code class="language-stdout">$ flag: SEKAI{15_React_N@71v3_R3v3rs3_H@RD???}
</code></pre>
<p align='right'>Author: akiidjk </p>

</article>
</div>
   
      </div>
    </main>
<footer>
    <article>Copyright ¬© 2024 by ByteTheCookies Team | v1.0</article>
</footer>

</body>
</html>
